# MultiHCAutoReset プラグイン ガイド

## 概要
このプラグインは、Minecraftのハードコアサーバーでプレイヤーが死亡した際に、自動的にワールドをリセットする機能を提供します。エンドでの特殊な死亡処理も実装されており、より戦略的なプレイが可能です。

## 必要なもの
- **サーバー**: Purpur / Paper / Spigot（1.20.5以上推奨）
- **プラグイン**: `MultiHCAutoReset.jar`
- **OS**: Windows（`.bat`ファイルを使用）
- **Java**: 21

## プラグインサーバーの構築手順

> ⚠️ より詳細なサーバー構築方法やポート開放については自分で調べてください

### 1. Javaのインストール
1. [Oracle公式サイト](https://www.oracle.com/java/technologies/downloads/)からJava 21をダウンロード
2. インストーラーを実行し、指示に従ってインストール
3. インストール後、コマンドプロンプトで`java -version`を実行して確認

### 2. サーバーの準備
1. 新しいフォルダを作成（例：`minecraft_server`）
2. 以下のいずれかのサーバーをダウンロード：
    - [Purpur](https://purpurmc.org/downloads)（推奨）
    - [Paper](https://papermc.io/downloads)
    - [Spigot](https://getbukkit.org/download/spigot)

### 3. サーバーの初期設定
1. ダウンロードした`.jar`ファイルをサーバーフォルダに配置
2. 以下の内容で`start_server.bat`を作成：

```bat
@echo off
:RESTART
java -Xmx2G -jar purpur-1.21.5.jar nogui

echo Server has stopped.

if exist reset.flag (
    echo Resetting worlds...
    rmdir /s /q world
    rmdir /s /q world_nether
    rmdir /s /q world_the_end
    del reset.flag
)

goto RESTART
```

> ⚠️ `purpur-1.21.5.jar`は、使用しているサーバーの`.jar`名に変更してください。

3. `start_server.bat`を実行してサーバーを起動
4. 初回起動時に`eula.txt`が作成されるので、`eula=true`に変更
5. サーバーを再起動

### 4. サーバーの基本設定
`server.properties`を編集し、以下の設定にしてください。：
- `difficulty=hard`（難易度）
- `spawn-protection=0`（スポーン保護無効）
- `hardcore=true` (ハードコアに設定)


### 5. プラグインの導入
1. プラグインの`.jar`ファイルを`plugins`フォルダに配置
2. サーバーを再起動


## 使い方

### サーバーの起動
**必ず** `start_server.bat`をダブルクリックして起動してください。
直接`.jar`を起動すると、ワールドリセットが正しく機能しません。

### 死亡時の動作

#### 通常のワールド（オーバーワールド・ネザー）
1. プレイヤーが死亡すると即座にリセットカウントダウン開始
2. 全プレイヤーに死亡通知
3. 2秒後に全員がスペクテイターモードに
4. 10秒後にサーバー再起動

#### エンド
1. プレイヤーの死亡を記録
2. エンドにいる全プレイヤーが死亡した場合のみリセット開始
3. 以降は通常のワールドと同じ動作

### リセットの流れ
1. 死亡通知
   ```
   [プレイヤー名]が死亡しました。ワールドリセットを開始します 2秒後にスペクテイターモードへ移行します。
   ```

2. スペクテイターモード移行
    - 全プレイヤーが自動的にスペクテイターモードに

3. カウントダウン
   ```
   サーバー再起動まで残り[秒数]秒
   ```

4. サーバー再起動
   ```
   サーバーを再起動します...
   ```

## 注意事項
- サーバーを完全に終了したい場合は、必ずサーバーのウィンドウを直接閉じてください
- `stop`コマンドを使用しても、サーバーが再起動されてしまいます。

## 動作確認表

| 状況 | 結果 |
|------|------|
| オーバーワールドで死亡 | 10秒後に自動リセット |
| ネザーで死亡 | 10秒後に自動リセット |
| エンドで死亡 | 全員が死亡するまで待機 |

## よくある質問

### Q: リセットの待ち時間を変更できますか？
A: 現在のバージョンでは10秒に固定されています。


## トラブルシューティング

### プラグインが読み込まれない場合
- サーバーのバージョンが1.20.5以上であることを確認
- `plugins`フォルダに正しく`.jar`ファイルが配置されているか確認
- サーバーのコンソールでエラーメッセージを確認

### ワールドがリセットされない場合
- `start_server.bat`で起動しているか確認
- ワールドフォルダがロックされていないか確認 